!function(e){function n(e){var n=require("./../dist/hot-update.js");!function(e,n){if(!v[e]||!b[e])return;for(var t in b[e]=!1,n)Object.prototype.hasOwnProperty.call(n,t)&&(f[t]=n[t]);0==--m&&0===g&&x()}(n.id,n.modules)}var t,o=!0,r="33caefcb3383dde66994",s={},c=[],i=[];function a(e){var n=O[e];if(!n)return S;var o=function(o){return n.hot.active?(O[o]?-1===O[o].parents.indexOf(e)&&O[o].parents.push(e):(c=[e],t=o),-1===n.children.indexOf(o)&&n.children.push(o)):(console.warn("[HMR] unexpected require("+o+") from disposed module "+e),c=[]),S(o)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return S[e]},set:function(n){S[e]=n}}};for(var s in S)Object.prototype.hasOwnProperty.call(S,s)&&"e"!==s&&"t"!==s&&Object.defineProperty(o,s,r(s));return o.e=function(e){return"ready"===u&&l("prepare"),g++,S.e(e).then(n,function(e){throw n(),e});function n(){g--,"prepare"===u&&(y[e]||w(e),0===g&&0===m&&x())}},o.t=function(e,n){return 1&n&&(e=o(e)),S.t(e,-2&n)},o}var d=[],u="idle";function l(e){u=e;for(var n=0;n<d.length;n++)d[n].call(null,e)}var p,f,h,m=0,g=0,y={},b={},v={};function j(e){return+e+""===e?+e:e}function _(e){if("idle"!==u)throw new Error("check() is only allowed in idle status");return o=e,l("check"),function(){try{var e=require("./../dist/hot-update.json")}catch(e){return Promise.resolve()}return Promise.resolve(e)}().then(function(e){if(!e)return l("idle"),null;b={},y={},v=e.c,h=e.h,l("prepare");var n=new Promise(function(e,n){p={resolve:e,reject:n}});f={};return w(0),"prepare"===u&&0===g&&0===m&&x(),n})}function w(e){v[e]?(b[e]=!0,m++,n()):y[e]=!0}function x(){l("ready");var e=p;if(p=null,e)if(o)Promise.resolve().then(function(){return E(o)}).then(function(n){e.resolve(n)},function(n){e.reject(n)});else{var n=[];for(var t in f)Object.prototype.hasOwnProperty.call(f,t)&&n.push(j(t));e.resolve(n)}}function E(n){if("ready"!==u)throw new Error("apply() is only allowed in ready status");var t,o,i,a,d;function p(e){for(var n=[e],t={},o=n.slice().map(function(e){return{chain:[e],id:e}});o.length>0;){var r=o.pop(),s=r.id,c=r.chain;if((a=O[s])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:"self-declined",chain:c,moduleId:s};if(a.hot._main)return{type:"unaccepted",chain:c,moduleId:s};for(var i=0;i<a.parents.length;i++){var d=a.parents[i],u=O[d];if(u){if(u.hot._declinedDependencies[s])return{type:"declined",chain:c.concat([d]),moduleId:s,parentId:d};-1===n.indexOf(d)&&(u.hot._acceptedDependencies[s]?(t[d]||(t[d]=[]),m(t[d],[s])):(delete t[d],n.push(d),o.push({chain:c.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:n,outdatedDependencies:t}}function m(e,n){for(var t=0;t<n.length;t++){var o=n[t];-1===e.indexOf(o)&&e.push(o)}}n=n||{};var g={},y=[],b={},_=function(){console.warn("[HMR] unexpected require("+x.moduleId+") to disposed module")};for(var w in f)if(Object.prototype.hasOwnProperty.call(f,w)){var x;d=j(w);var E=!1,T=!1,D=!1,I="";switch((x=f[w]?p(d):{type:"disposed",moduleId:w}).chain&&(I="\nUpdate propagation: "+x.chain.join(" -> ")),x.type){case"self-declined":n.onDeclined&&n.onDeclined(x),n.ignoreDeclined||(E=new Error("Aborted because of self decline: "+x.moduleId+I));break;case"declined":n.onDeclined&&n.onDeclined(x),n.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+x.moduleId+" in "+x.parentId+I));break;case"unaccepted":n.onUnaccepted&&n.onUnaccepted(x),n.ignoreUnaccepted||(E=new Error("Aborted because "+d+" is not accepted"+I));break;case"accepted":n.onAccepted&&n.onAccepted(x),T=!0;break;case"disposed":n.onDisposed&&n.onDisposed(x),D=!0;break;default:throw new Error("Unexception type "+x.type)}if(E)return l("abort"),Promise.reject(E);if(T)for(d in b[d]=f[d],m(y,x.outdatedModules),x.outdatedDependencies)Object.prototype.hasOwnProperty.call(x.outdatedDependencies,d)&&(g[d]||(g[d]=[]),m(g[d],x.outdatedDependencies[d]));D&&(m(y,[x.moduleId]),b[d]=_)}var k,P=[];for(o=0;o<y.length;o++)d=y[o],O[d]&&O[d].hot._selfAccepted&&P.push({module:d,errorHandler:O[d].hot._selfAccepted});l("dispose"),Object.keys(v).forEach(function(e){!1===v[e]&&function(e){delete installedChunks[e]}(e)});for(var A,R,U=y.slice();U.length>0;)if(d=U.pop(),a=O[d]){var H={},L=a.hot._disposeHandlers;for(i=0;i<L.length;i++)(t=L[i])(H);for(s[d]=H,a.hot.active=!1,delete O[d],delete g[d],i=0;i<a.children.length;i++){var M=O[a.children[i]];M&&((k=M.parents.indexOf(d))>=0&&M.parents.splice(k,1))}}for(d in g)if(Object.prototype.hasOwnProperty.call(g,d)&&(a=O[d]))for(R=g[d],i=0;i<R.length;i++)A=R[i],(k=a.children.indexOf(A))>=0&&a.children.splice(k,1);for(d in l("apply"),r=h,b)Object.prototype.hasOwnProperty.call(b,d)&&(e[d]=b[d]);var q=null;for(d in g)if(Object.prototype.hasOwnProperty.call(g,d)&&(a=O[d])){R=g[d];var C=[];for(o=0;o<R.length;o++)if(A=R[o],t=a.hot._acceptedDependencies[A]){if(-1!==C.indexOf(t))continue;C.push(t)}for(o=0;o<C.length;o++){t=C[o];try{t(R)}catch(e){n.onErrored&&n.onErrored({type:"accept-errored",moduleId:d,dependencyId:R[o],error:e}),n.ignoreErrored||q||(q=e)}}}for(o=0;o<P.length;o++){var N=P[o];d=N.module,c=[d];try{S(d)}catch(e){if("function"==typeof N.errorHandler)try{N.errorHandler(e)}catch(t){n.onErrored&&n.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:t,originalError:e}),n.ignoreErrored||q||(q=t),q||(q=e)}else n.onErrored&&n.onErrored({type:"self-accept-errored",moduleId:d,error:e}),n.ignoreErrored||q||(q=e)}}return q?(l("fail"),Promise.reject(q)):(l("idle"),new Promise(function(e){e(y)}))}var O={};function S(n){if(O[n])return O[n].exports;var o=O[n]={i:n,l:!1,exports:{},hot:function(e){var n={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:t!==e,active:!0,accept:function(e,t){if(void 0===e)n._selfAccepted=!0;else if("function"==typeof e)n._selfAccepted=e;else if("object"==typeof e)for(var o=0;o<e.length;o++)n._acceptedDependencies[e[o]]=t||function(){};else n._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)n._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)n._declinedDependencies[e[t]]=!0;else n._declinedDependencies[e]=!0},dispose:function(e){n._disposeHandlers.push(e)},addDisposeHandler:function(e){n._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=n._disposeHandlers.indexOf(e);t>=0&&n._disposeHandlers.splice(t,1)},check:_,apply:E,status:function(e){if(!e)return u;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var n=d.indexOf(e);n>=0&&d.splice(n,1)},data:s[e]};return t=void 0,n}(n),parents:(i=c,c=[],i),children:[]};return e[n].call(o.exports,o,o.exports,a(n)),o.l=!0,o.exports}S.m=e,S.c=O,S.d=function(e,n,t){S.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},S.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},S.t=function(e,n){if(1&n&&(e=S(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(S.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)S.d(t,o,function(n){return e[n]}.bind(null,o));return t},S.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return S.d(n,"a",n),n},S.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},S.p="",S.h=function(){return r},a(0)(S.s=0)}({"../app.js":function(e,n,t){const o=t("express")(),r=t("body-parser");o.use(r.urlencoded({extended:!1})),o.all("*",function(e,n,t){n.header("Access-Control-Allow-Origin","*"),n.header("Access-Control-Allow-Headers","content-type, Authorization"),n.header("Access-Control-Allow-Methods","DELETE,PUT,POST,GET,OPTIONS"),"options"==e.method.toLowerCase()?n.send(200):t()}),o.all("/*",function(e,n,t){t()});const s=t("../config/index.js"),c=t("../controller/index.js");t("../route/route.js").map(e=>{console.log(`route ${e.method}:${e.path}`);let n=e.impl.split(".");return e.impl=c[n[0]][n[1]],e}).find(e=>{o[e.method](e.path,(n,t)=>{e?e.impl(n,t):(t.statusCode=404,t.setHeader("Content-Type","text/plain"),t.end("Not Found"))})}),o.listen(s.port,s.hostname,()=>{console.log(`Server running at http://${s.hostname}:${s.port}/`)})},"../config/index.js":function(e,n){e.exports={hostname:"192.168.1.213",port:"3000"}},"../controller/index.js":function(e,n,t){n.user=t("../controller/user.js")},"../controller/user.js":function(e,n,t){"use strict";function o(e,n){if(0===arguments.length)return null;const t=n||"{y}-{m}-{d} {h}:{i}:{s}";let o;"object"==typeof e?o=e:(10===(""+e).length&&(e=1e3*parseInt(e)),o=new Date(e));const r={y:o.getFullYear(),m:o.getMonth()+1,d:o.getDate(),h:o.getHours(),i:o.getMinutes(),s:o.getSeconds(),a:o.getDay()};return t.replace(/{(y|m|d|h|i|s|a)+}/g,(e,n)=>{let t=r[n];return"a"===n?["日","一","二","三","四","五","六"][t]:(e.length>0&&t<10&&(t="0"+t),t||0)})}t.r(n);t.d(n,"register",function(){return c}),t.d(n,"login",function(){return i}),t.d(n,"logout",function(){return a}),t.d(n,"getUserInfo",function(){return d}),t.d(n,"list",function(){return u}),t.d(n,"add",function(){return l}),t.d(n,"del",function(){return p}),t.d(n,"updata",function(){return f});const r=t("../utils/token.js"),s=t("../controller/userModal.js");function c(e,n){s.register(e,n,function(e,t){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"注册成功"})})}function i(e,n){s.login(e,function(t,s){return t?n.json({code:-1,success:!1,message:t}):s.length<=0?n.json({code:-1,success:!1,message:"账号或密码错误"}):void n.json({code:200,success:!0,message:"登陆成功",token:r.setToken({id:s[0].id,account:e.body.account,password:e.body.password,time:o(new Date)})})})}function a(e,n){n.json({code:200,success:!0,message:"成功退出"})}function d(e,n){r.getToken(e.headers.authorization,n,function(t){if(t.success){let a=new Date(t.user.time),d=new Date,u=(c=a,(i=d.getTime()-c.getTime())<0?0:Math.floor(i/1e3/60/60));s.info(e,t.user.account,function(t,s){if(t)return n.json({code:-1,success:!1,message:t});delete s[0].password,s[0].roles=s[0].roles.split(",");let c="";u>23&&u<=24&&(c=r.setToken({id:s[0].id,account:e.body.account,password:e.body.password,time:o(new Date)})),n.json({code:200,success:!0,message:"用户信息获取成功",data:s[0],token:c})})}var c,i})}function u(e,n){r.getToken(e.headers.authorization,n,function(t){t.success&&s.list(e,function(t,r){var s=e.body;if(t)return n.json({code:-1,success:!1,message:"数据不存在"});for(var c in r[1])r[1][c].birthday=o(r[1][c].birthday,"{y}-{m}-{d}"),delete r[1][c].password;n.json({code:200,success:!0,pageNo:s.pageNo,pageSize:s.pageSize,total:r[0][0]["COUNT(*)"],data:r[1]})})})}function l(e,n){r.getToken(e.headers.authorization,n,function(t){s.add(e,function(e,t){if(e)return n.json({err_code:-1,success:!1,message:e});n.json({err_code:200,success:!0,message:"添加成功"})})})}function p(e,n){r.getToken(e.headers.authorization,n,function(t){s.del(e,function(e,t){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"删除成功"})})})}function f(e,n){r.getToken(e.headers.authorization,n,function(t){s.updata(e,function(e,t){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"编辑成功"})})})}},"../controller/userModal.js":function(e,n,t){t("mysql");const o=t("../utils/SQLcool.js").sqlpool();t("../utils/token.js");var r=t("md5-node");function s(e,n){n=void 0===n?3:n;for(let t=0;t<n;t++)e=r(e);return e}e.exports={register:function(e,n,t){const r=e.body;this.validateAccount(e,function(e,c){if(r.user_name&&""!=r.user_name)if(c.length>0)n.json({code:-1,success:!1,message:"该账号已存在，请重新填写"});else{const e="INSERT INTO USER_LIST(account, password, user_name, sex, age, birthday, roles) VALUES(?,?,?,?,?,?,?)";r.password=s(r.password);var i=[r.account,r.password,r.user_name,r.sex||null,r.age||null,r.birthday||null,r.roles||"admin"];o.connect(e,i,t)}else n.json({code:-1,success:!1,message:"请填写用户名"})})},validateAccount:function(e,n){const t=e.body;o.connect("SELECT * FROM USER_LIST where 1=1 and account=?",[t.account],n)},login:function(e,n){const t=e.body;t.password=s(t.password);var r=[t.account,t.password];o.connect("SELECT * FROM USER_LIST WHERE account=? and password=?",r,n)},info:function(e,n,t){o.connect("SELECT * FROM USER_LIST where account=?",n,t)},list:function(e,n){const t=e.body;let r=[],s="SELECT COUNT(*) FROM USER_LIST";""!=t.user_name||""!=t.sex||""!=t.age||""!=t.birthday?(s+=" where 1=1",t.user_name&&""!=t.user_name&&(t.user_name="%"+t.user_name+"%",s+=" and user_name like ?",r.push(t.user_name)),t.sex&&""!=t.sex&&(s+=" and sex = ?",r.push(t.sex)),t.age&&""!=t.age&&(s+=" and age = ?",r.push(t.age)),t.birthday&&""!=t.birthday&&(s+=" and birthday = ?",r.push(t.birthday)),s+=";"):s+=";",s+="SELECT * FROM USER_LIST where 1=1",t.user_name&&""!=t.user_name&&(t.user_name="%"+t.user_name+"%",s+=" and user_name like ?",r.push(t.user_name)),t.sex&&""!=t.sex&&(s+=" and sex = ?",r.push(t.sex)),t.age&&""!=t.age&&(s+=" and age = ?",r.push(t.age)),t.birthday&&""!=t.birthday&&(s+=" and birthday = ?",r.push(t.birthday)),s+=" limit ?,?",r.push(Number(t.pageNo-1)*Number(t.pageSize)||0,Number(t.pageSize)||10),o.connect(s,r,n)},add:function(e,n){const t=e.body;var r=[t.user_name,t.sex,t.age,t.birthday];o.connect("INSERT INTO USER_LIST( user_name, sex, age, birthday) VALUES(?,?,?,?)",r,n)},del:function(e,n){const t=e.body;let r="?";if("string"!=typeof t.ids)for(var s=0;s<t.ids.length-1;s++)r+=",?";else t.ids=[t.ids];const c="DELETE FROM USER_LIST WHERE id in("+r+")";o.connect(c,t.ids,n)},updata:function(e,n){const t=e.body,r="UPDATE USER_LIST SET user_name=?, sex=?, age=?, birthday=? WHERE id = "+t.id;var s=[t.user_name,t.sex,t.age,new Date(t.birthday),t.id];o.connect(r,s,n)}}},"../route/route.js":function(e,n){e.exports=[{method:"post",path:"/api/register",impl:"user.register"},{method:"post",path:"/api/login",impl:"user.login"},{method:"post",path:"/api/logout",impl:"user.logout"},{method:"post",path:"/api/userinfo",impl:"user.getUserInfo"},{method:"post",path:"/api/userlist",impl:"user.list"},{method:"post",path:"/api/deluser",impl:"user.del"},{method:"post",path:"/api/updatauser",impl:"user.updata"}]},"../utils/SQLcool.js":function(e,n,t){const o=t("mysql");t("body-parser");e.exports.sqlpool=function(){return{config:{host:"39.106.16.151",user:"root",password:"zhishan_888",port:"3306",database:"xiaolongjun",multipleStatements:!0},connect:function(e,n,t){o.createPool(this.config).getConnection(function(o,r){o?console.log(o):r.query(e,n,t)})}}}},"../utils/token.js":function(e,n,t){const o=t("jsonwebtoken"),r=t("fs").readFileSync("./config/private.key");e.exports={setToken:function(e){return o.sign(e,r,{expiresIn:86400})},getToken:function(e,n,t){o.verify(e,r,(e,o)=>{if(e)return console.log(e.message),void n.json({code:50014,success:!1,message:"请重新登陆"});"function"==typeof t&&t({user:o,success:!0})})}}},0:function(e,n,t){e.exports=t("../app.js")},"body-parser":function(e,n){e.exports=require("body-parser")},express:function(e,n){e.exports=require("express")},fs:function(e,n){e.exports=require("fs")},jsonwebtoken:function(e,n){e.exports=require("jsonwebtoken")},"md5-node":function(e,n){e.exports=require("md5-node")},mysql:function(e,n){e.exports=require("mysql")}});