exports.id=0,exports.modules={"../controller/user.js":function(e,s,n){"use strict";function t(e,s){if(0===arguments.length)return null;const n=s||"{y}-{m}-{d} {h}:{i}:{s}";let t;"object"==typeof e?t=e:(10===(""+e).length&&(e=1e3*parseInt(e)),t=new Date(e));const o={y:t.getFullYear(),m:t.getMonth()+1,d:t.getDate(),h:t.getHours(),i:t.getMinutes(),s:t.getSeconds(),a:t.getDay()};return n.replace(/{(y|m|d|h|i|s|a)+}/g,(e,s)=>{let n=o[s];return"a"===s?["日","一","二","三","四","五","六"][n]:(e.length>0&&n<10&&(n="0"+n),n||0)})}n.r(s);n.d(s,"register",function(){return r}),n.d(s,"login",function(){return u}),n.d(s,"getUserInfo",function(){return i}),n.d(s,"list",function(){return a}),n.d(s,"add",function(){return d}),n.d(s,"del",function(){return g}),n.d(s,"update",function(){return f});const o=n("../utils/token.js"),c=n("../controller/userModal.js");function r(e,s){c.register(e,s,function(e,n){if(e)return s.json({code:1,success:!1,message:e});s.json({code:200,success:!0,message:"注册成功"})})}function u(e,s){c.login(e,function(n,c){return n?s.json({code:1,success:!1,message:n}):c.length<=0?s.json({code:200,success:!1,message:"账号或密码错误"}):void s.json({code:200,success:!0,message:"登陆成功",token:o.setToken({id:c[0].id,account:e.body.account,password:e.body.password,time:t(new Date)})})})}function i(e,s){o.getToken(e.headers.authorization,function(n){if(n.success){let i=new Date(n.user.time),a=new Date,d=(r=i,(u=a.getTime()-r.getTime())<0?0:Math.floor(u/1e3/60/60));c.info(e,n.user.account,function(n,c){if(n)return s.json({code:1,success:!1,message:n});delete c[0].password,c[0].roles=c[0].roles.split(",");let r="";d>23&&d<=24&&(r=o.setToken({id:c[0].id,account:e.body.account,password:e.body.password,time:t(new Date)})),s.json({code:200,success:!0,message:"用户信息获取成功",data:c[0],token:r})})}else s.json({code:-1,success:!1,message:"请重新登陆"});var r,u})}function a(e,s){c.list(e,function(n,t){var o=e.body;if(n)return s.json({code:1,success:!1,message:"数据不存在"});s.json({code:200,success:!0,pageNo:o.pageNo,pageSize:o.pageSize,total:t[0][0]["COUNT(*)"],data:t[1]})})}function d(e,s){c.add(e,function(e,n){if(e)return s.json({err_code:1,message:e});s.json({err_code:0,message:"添加成功"})})}function g(e,s){c.del(e,function(e,n){if(e)return s.json({code:1,message:e});s.json({code:0,message:"删除成功"})})}function f(e,s){c.update(e,function(e,n){if(e)return s.json({code:1,message:e});s.json({code:0,message:"编辑成功"})})}}};