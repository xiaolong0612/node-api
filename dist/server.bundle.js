!function(e){function n(e){var n=require("./../dist/hot-update.js");!function(e,n){if(!v[e]||!b[e])return;for(var o in b[e]=!1,n)Object.prototype.hasOwnProperty.call(n,o)&&(f[o]=n[o]);0==--g&&0===m&&E()}(n.id,n.modules)}var o,t=!0,r="d19fa9aa046a3d89a0a0",s={},c=[],i=[];function d(e){var n=O[e];if(!n)return S;var t=function(t){return n.hot.active?(O[t]?-1===O[t].parents.indexOf(e)&&O[t].parents.push(e):(c=[e],o=t),-1===n.children.indexOf(t)&&n.children.push(t)):(console.warn("[HMR] unexpected require("+t+") from disposed module "+e),c=[]),S(t)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return S[e]},set:function(n){S[e]=n}}};for(var s in S)Object.prototype.hasOwnProperty.call(S,s)&&"e"!==s&&"t"!==s&&Object.defineProperty(t,s,r(s));return t.e=function(e){return"ready"===u&&l("prepare"),m++,S.e(e).then(n,function(e){throw n(),e});function n(){m--,"prepare"===u&&(y[e]||w(e),0===m&&0===g&&E())}},t.t=function(e,n){return 1&n&&(e=t(e)),S.t(e,-2&n)},t}var a=[],u="idle";function l(e){u=e;for(var n=0;n<a.length;n++)a[n].call(null,e)}var p,f,h,g=0,m=0,y={},b={},v={};function j(e){return+e+""===e?+e:e}function _(e){if("idle"!==u)throw new Error("check() is only allowed in idle status");return t=e,l("check"),function(){try{var e=require("./../dist/hot-update.json")}catch(e){return Promise.resolve()}return Promise.resolve(e)}().then(function(e){if(!e)return l("idle"),null;b={},y={},v=e.c,h=e.h,l("prepare");var n=new Promise(function(e,n){p={resolve:e,reject:n}});f={};return w(0),"prepare"===u&&0===m&&0===g&&E(),n})}function w(e){v[e]?(b[e]=!0,g++,n()):y[e]=!0}function E(){l("ready");var e=p;if(p=null,e)if(t)Promise.resolve().then(function(){return x(t)}).then(function(n){e.resolve(n)},function(n){e.reject(n)});else{var n=[];for(var o in f)Object.prototype.hasOwnProperty.call(f,o)&&n.push(j(o));e.resolve(n)}}function x(n){if("ready"!==u)throw new Error("apply() is only allowed in ready status");var o,t,i,d,a;function p(e){for(var n=[e],o={},t=n.slice().map(function(e){return{chain:[e],id:e}});t.length>0;){var r=t.pop(),s=r.id,c=r.chain;if((d=O[s])&&!d.hot._selfAccepted){if(d.hot._selfDeclined)return{type:"self-declined",chain:c,moduleId:s};if(d.hot._main)return{type:"unaccepted",chain:c,moduleId:s};for(var i=0;i<d.parents.length;i++){var a=d.parents[i],u=O[a];if(u){if(u.hot._declinedDependencies[s])return{type:"declined",chain:c.concat([a]),moduleId:s,parentId:a};-1===n.indexOf(a)&&(u.hot._acceptedDependencies[s]?(o[a]||(o[a]=[]),g(o[a],[s])):(delete o[a],n.push(a),t.push({chain:c.concat([a]),id:a})))}}}}return{type:"accepted",moduleId:e,outdatedModules:n,outdatedDependencies:o}}function g(e,n){for(var o=0;o<n.length;o++){var t=n[o];-1===e.indexOf(t)&&e.push(t)}}n=n||{};var m={},y=[],b={},_=function(){console.warn("[HMR] unexpected require("+E.moduleId+") to disposed module")};for(var w in f)if(Object.prototype.hasOwnProperty.call(f,w)){var E;a=j(w);var x=!1,T=!1,D=!1,I="";switch((E=f[w]?p(a):{type:"disposed",moduleId:w}).chain&&(I="\nUpdate propagation: "+E.chain.join(" -> ")),E.type){case"self-declined":n.onDeclined&&n.onDeclined(E),n.ignoreDeclined||(x=new Error("Aborted because of self decline: "+E.moduleId+I));break;case"declined":n.onDeclined&&n.onDeclined(E),n.ignoreDeclined||(x=new Error("Aborted because of declined dependency: "+E.moduleId+" in "+E.parentId+I));break;case"unaccepted":n.onUnaccepted&&n.onUnaccepted(E),n.ignoreUnaccepted||(x=new Error("Aborted because "+a+" is not accepted"+I));break;case"accepted":n.onAccepted&&n.onAccepted(E),T=!0;break;case"disposed":n.onDisposed&&n.onDisposed(E),D=!0;break;default:throw new Error("Unexception type "+E.type)}if(x)return l("abort"),Promise.reject(x);if(T)for(a in b[a]=f[a],g(y,E.outdatedModules),E.outdatedDependencies)Object.prototype.hasOwnProperty.call(E.outdatedDependencies,a)&&(m[a]||(m[a]=[]),g(m[a],E.outdatedDependencies[a]));D&&(g(y,[E.moduleId]),b[a]=_)}var k,P=[];for(t=0;t<y.length;t++)a=y[t],O[a]&&O[a].hot._selfAccepted&&P.push({module:a,errorHandler:O[a].hot._selfAccepted});l("dispose"),Object.keys(v).forEach(function(e){!1===v[e]&&function(e){delete installedChunks[e]}(e)});for(var A,R,U=y.slice();U.length>0;)if(a=U.pop(),d=O[a]){var H={},L=d.hot._disposeHandlers;for(i=0;i<L.length;i++)(o=L[i])(H);for(s[a]=H,d.hot.active=!1,delete O[a],delete m[a],i=0;i<d.children.length;i++){var M=O[d.children[i]];M&&((k=M.parents.indexOf(a))>=0&&M.parents.splice(k,1))}}for(a in m)if(Object.prototype.hasOwnProperty.call(m,a)&&(d=O[a]))for(R=m[a],i=0;i<R.length;i++)A=R[i],(k=d.children.indexOf(A))>=0&&d.children.splice(k,1);for(a in l("apply"),r=h,b)Object.prototype.hasOwnProperty.call(b,a)&&(e[a]=b[a]);var q=null;for(a in m)if(Object.prototype.hasOwnProperty.call(m,a)&&(d=O[a])){R=m[a];var C=[];for(t=0;t<R.length;t++)if(A=R[t],o=d.hot._acceptedDependencies[A]){if(-1!==C.indexOf(o))continue;C.push(o)}for(t=0;t<C.length;t++){o=C[t];try{o(R)}catch(e){n.onErrored&&n.onErrored({type:"accept-errored",moduleId:a,dependencyId:R[t],error:e}),n.ignoreErrored||q||(q=e)}}}for(t=0;t<P.length;t++){var N=P[t];a=N.module,c=[a];try{S(a)}catch(e){if("function"==typeof N.errorHandler)try{N.errorHandler(e)}catch(o){n.onErrored&&n.onErrored({type:"self-accept-error-handler-errored",moduleId:a,error:o,originalError:e}),n.ignoreErrored||q||(q=o),q||(q=e)}else n.onErrored&&n.onErrored({type:"self-accept-errored",moduleId:a,error:e}),n.ignoreErrored||q||(q=e)}}return q?(l("fail"),Promise.reject(q)):(l("idle"),new Promise(function(e){e(y)}))}var O={};function S(n){if(O[n])return O[n].exports;var t=O[n]={i:n,l:!1,exports:{},hot:function(e){var n={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:o!==e,active:!0,accept:function(e,o){if(void 0===e)n._selfAccepted=!0;else if("function"==typeof e)n._selfAccepted=e;else if("object"==typeof e)for(var t=0;t<e.length;t++)n._acceptedDependencies[e[t]]=o||function(){};else n._acceptedDependencies[e]=o||function(){}},decline:function(e){if(void 0===e)n._selfDeclined=!0;else if("object"==typeof e)for(var o=0;o<e.length;o++)n._declinedDependencies[e[o]]=!0;else n._declinedDependencies[e]=!0},dispose:function(e){n._disposeHandlers.push(e)},addDisposeHandler:function(e){n._disposeHandlers.push(e)},removeDisposeHandler:function(e){var o=n._disposeHandlers.indexOf(e);o>=0&&n._disposeHandlers.splice(o,1)},check:_,apply:x,status:function(e){if(!e)return u;a.push(e)},addStatusHandler:function(e){a.push(e)},removeStatusHandler:function(e){var n=a.indexOf(e);n>=0&&a.splice(n,1)},data:s[e]};return o=void 0,n}(n),parents:(i=c,c=[],i),children:[]};return e[n].call(t.exports,t,t.exports,d(n)),t.l=!0,t.exports}S.m=e,S.c=O,S.d=function(e,n,o){S.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},S.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},S.t=function(e,n){if(1&n&&(e=S(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(S.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var t in e)S.d(o,t,function(n){return e[n]}.bind(null,t));return o},S.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return S.d(n,"a",n),n},S.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},S.p="",S.h=function(){return r},d(0)(S.s=0)}({"../app.js":function(e,n,o){const t=o("express")(),r=o("body-parser");t.use(r.urlencoded({extended:!1})),t.all("*",function(e,n,o){n.header("Access-Control-Allow-Origin","*"),n.header("Access-Control-Allow-Headers","content-type, Authorization"),n.header("Access-Control-Allow-Methods","DELETE,PUT,POST,GET,OPTIONS"),"options"==e.method.toLowerCase()?n.send(200):o()}),t.all("/*",function(e,n,o){o()});const s=o("../config/index.js"),c=o("../controller/index.js");o("../route/route.js").map(e=>{console.log(`route ${e.method}:${e.path}`);let n=e.impl.split(".");return e.impl=c[n[0]][n[1]],e}).find(e=>{t[e.method](e.path,(n,o)=>{e?e.impl(n,o):(o.statusCode=404,o.setHeader("Content-Type","text/plain"),o.end("Not Found"))})}),t.listen(s.port,s.hostname,()=>{console.log(`Server running at http://${s.hostname}:${s.port}/`)})},"../config/index.js":function(e,n){e.exports={hostname:"192.168.1.213",port:"3000"}},"../controller/index.js":function(e,n,o){n.user=o("../controller/user.js")},"../controller/user.js":function(e,n,o){"use strict";function t(e,n){if(0===arguments.length)return null;const o=n||"{y}-{m}-{d} {h}:{i}:{s}";let t;"object"==typeof e?t=e:(10===(""+e).length&&(e=1e3*parseInt(e)),t=new Date(e));const r={y:t.getFullYear(),m:t.getMonth()+1,d:t.getDate(),h:t.getHours(),i:t.getMinutes(),s:t.getSeconds(),a:t.getDay()};return o.replace(/{(y|m|d|h|i|s|a)+}/g,(e,n)=>{let o=r[n];return"a"===n?["日","一","二","三","四","五","六"][o]:(e.length>0&&o<10&&(o="0"+o),o||0)})}o.r(n);o.d(n,"register",function(){return c}),o.d(n,"login",function(){return i}),o.d(n,"logout",function(){return d}),o.d(n,"getUserInfo",function(){return a}),o.d(n,"list",function(){return u}),o.d(n,"add",function(){return l}),o.d(n,"del",function(){return p}),o.d(n,"updata",function(){return f});const r=o("../utils/token.js"),s=o("../controller/userModal.js");function c(e,n){s.register(e,n,function(e,o){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"注册成功"})})}function i(e,n){s.login(e,function(o,s){return o?n.json({code:-1,success:!1,message:o}):s.length<=0?n.json({code:-1,success:!1,message:"账号或密码错误"}):void n.json({code:200,success:!0,message:"登陆成功",token:r.setToken({id:s[0].id,account:e.body.account,password:e.body.password,time:t(new Date)})})})}function d(e,n){n.json({code:200,success:!0,message:"成功退出"})}function a(e,n){r.getToken(e.headers.authorization,function(o){if(o.success){let d=new Date(o.user.time),a=new Date,u=(c=d,(i=a.getTime()-c.getTime())<0?0:Math.floor(i/1e3/60/60));s.info(e,o.user.account,function(o,s){if(o)return n.json({code:-1,success:!1,message:o});delete s[0].password,s[0].roles=s[0].roles.split(",");let c="";u>23&&u<=24&&(c=r.setToken({id:s[0].id,account:e.body.account,password:e.body.password,time:t(new Date)})),n.json({code:200,success:!0,message:"用户信息获取成功",data:s[0],token:c})})}else n.json({code:50014,success:!1,message:"请重新登陆"});var c,i})}function u(e,n){s.list(e,function(o,r){var s=e.body;if(o)return n.json({code:-1,success:!1,message:"数据不存在"});for(var c in r[1])r[1][c].birthday=t(r[1][c].birthday,"{y}-{m}-{d}"),delete r[1][c].password;n.json({code:200,success:!0,pageNo:s.pageNo,pageSize:s.pageSize,total:r[0][0]["COUNT(*)"],data:r[1]})})}function l(e,n){s.add(e,function(e,o){if(e)return n.json({err_code:-1,success:!1,message:e});n.json({err_code:200,success:!0,message:"添加成功"})})}function p(e,n){s.del(e,function(e,o){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"删除成功"})})}function f(e,n){s.updata(e,function(e,o){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"编辑成功"})})}},"../controller/userModal.js":function(e,n,o){o("mysql");const t=o("../utils/SQLcool.js").sqlpool();o("../utils/token.js");var r=o("md5-node");function s(e,n){n=void 0===n?3:n;for(let o=0;o<n;o++)e=r(e);return e}e.exports={register:function(e,n,o){const r=e.body;this.validateAccount(e,function(e,c){if(r.user_name&&""!=r.user_name)if(c.length>0)n.json({code:-1,success:!1,message:"该账号已存在，请重新填写"});else{const e="INSERT INTO USER_LIST(account, password, user_name, sex, age, birthday, roles) VALUES(?,?,?,?,?,?,?)";r.password=s(r.password);var i=[r.account,r.password,r.user_name,r.sex||null,r.age||null,r.birthday||null,r.roles||"admin"];console.log(r),console.log(i),t.connect(e,i,o)}else n.json({code:-1,success:!1,message:"请填写用户名"})})},validateAccount:function(e,n){const o=e.body;t.connect("SELECT * FROM USER_LIST where 1=1 and account=?",[o.account],n)},login:function(e,n){const o=e.body;o.password=s(o.password);var r=[o.account,o.password];t.connect("SELECT * FROM USER_LIST WHERE account=? and password=?",r,n)},info:function(e,n,o){t.connect("SELECT * FROM USER_LIST where account=?",n,o)},list:function(e,n){const o=e.body;let r="SELECT COUNT(*) FROM USER_LIST;";r+="SELECT * FROM USER_LIST where 1=1";let s=[];o.user_name&&""!=o.user_name&&(o.user_name="%"+o.user_name+"%",r+=" and user_name like ?",s.push(o.user_name)),o.sex&&""!=o.sex&&(o.sex="%"+o.sex+"%",r+=" and sex like ?",s.push(o.sex)),o.age&&""!=o.age&&(o.age="%"+o.age+"%",r+=" and age like ?",s.push(o.age)),o.birthday&&""!=o.birthday&&(o.birthday="%"+o.birthday+"%",r+=" and birthday like ?",s.push(o.birthday)),r+=" limit ?,?",s.push(Number(o.pageNo-1)||0,Number(o.pageSize)||10),t.connect(r,s,n)},add:function(e,n){const o=e.body;var r=[o.user_name,o.sex,o.age,o.birthday];t.connect("INSERT INTO USER_LIST( user_name, sex, age, birthday) VALUES(?,?,?,?)",r,n)},del:function(e,n){const o=e.body;let r="?";if("string"!=typeof o.ids)for(var s=0;s<o.ids.length-1;s++)r+=",?";else o.ids=[o.ids];console.log(o.ids);const c="DELETE FROM USER_LIST WHERE id in("+r+")";t.connect(c,o.ids,n)},updata:function(e,n){const o=e.body,r="UPDATE USER_LIST SET user_name=?, sex=?, age=?, birthday=? WHERE id = "+o.id;var s=[o.user_name,o.sex,o.age,new Date(o.birthday),o.id];t.connect(r,s,n)}}},"../route/route.js":function(e,n){e.exports=[{method:"post",path:"/api/register",impl:"user.register"},{method:"post",path:"/api/login",impl:"user.login"},{method:"post",path:"/api/logout",impl:"user.logout"},{method:"post",path:"/api/userinfo",impl:"user.getUserInfo"},{method:"post",path:"/api/userlist",impl:"user.list"},{method:"post",path:"/api/deluser",impl:"user.del"},{method:"post",path:"/api/updatauser",impl:"user.updata"}]},"../utils/SQLcool.js":function(e,n,o){const t=o("mysql");o("body-parser");e.exports.sqlpool=function(){return{config:{host:"39.106.16.151",user:"root",password:"zhishan_888",port:"3306",database:"xiaolongjun",multipleStatements:!0},connect:function(e,n,o){t.createPool(this.config).getConnection(function(t,r){t?console.log(t):r.query(e,n,o)})}}}},"../utils/token.js":function(e,n,o){const t=o("jsonwebtoken"),r=o("fs").readFileSync("./config/private.key");e.exports={setToken:function(e){return t.sign(e,r,{expiresIn:86400})},getToken:function(e,n){t.verify(e,r,(e,o)=>{if(e)return console.log(e.message),void("function"==typeof n&&n({success:!1}));"function"==typeof n&&n({user:o,success:!0})})}}},0:function(e,n,o){e.exports=o("../app.js")},"body-parser":function(e,n){e.exports=require("body-parser")},express:function(e,n){e.exports=require("express")},fs:function(e,n){e.exports=require("fs")},jsonwebtoken:function(e,n){e.exports=require("jsonwebtoken")},"md5-node":function(e,n){e.exports=require("md5-node")},mysql:function(e,n){e.exports=require("mysql")}});