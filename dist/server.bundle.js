!function(e){function n(e){var n=require("./../dist/hot-update.js");!function(e,n){if(!v[e]||!b[e])return;for(var o in b[e]=!1,n)Object.prototype.hasOwnProperty.call(n,o)&&(f[o]=n[o]);0==--g&&0===m&&w()}(n.id,n.modules)}var o,t=!0,r="f6ff10005a62a1ef7bc1",s={},i=[],c=[];function a(e){var n=S[e];if(!n)return O;var t=function(t){return n.hot.active?(S[t]?-1===S[t].parents.indexOf(e)&&S[t].parents.push(e):(i=[e],o=t),-1===n.children.indexOf(t)&&n.children.push(t)):(console.warn("[HMR] unexpected require("+t+") from disposed module "+e),i=[]),O(t)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return O[e]},set:function(n){O[e]=n}}};for(var s in O)Object.prototype.hasOwnProperty.call(O,s)&&"e"!==s&&"t"!==s&&Object.defineProperty(t,s,r(s));return t.e=function(e){return"ready"===u&&l("prepare"),m++,O.e(e).then(n,function(e){throw n(),e});function n(){m--,"prepare"===u&&(y[e]||x(e),0===m&&0===g&&w())}},t.t=function(e,n){return 1&n&&(e=t(e)),O.t(e,-2&n)},t}var d=[],u="idle";function l(e){u=e;for(var n=0;n<d.length;n++)d[n].call(null,e)}var p,f,h,g=0,m=0,y={},b={},v={};function j(e){return+e+""===e?+e:e}function _(e){if("idle"!==u)throw new Error("check() is only allowed in idle status");return t=e,l("check"),function(){try{var e=require("./../dist/hot-update.json")}catch(e){return Promise.resolve()}return Promise.resolve(e)}().then(function(e){if(!e)return l("idle"),null;b={},y={},v=e.c,h=e.h,l("prepare");var n=new Promise(function(e,n){p={resolve:e,reject:n}});f={};return x(0),"prepare"===u&&0===m&&0===g&&w(),n})}function x(e){v[e]?(b[e]=!0,g++,n()):y[e]=!0}function w(){l("ready");var e=p;if(p=null,e)if(t)Promise.resolve().then(function(){return E(t)}).then(function(n){e.resolve(n)},function(n){e.reject(n)});else{var n=[];for(var o in f)Object.prototype.hasOwnProperty.call(f,o)&&n.push(j(o));e.resolve(n)}}function E(n){if("ready"!==u)throw new Error("apply() is only allowed in ready status");var o,t,c,a,d;function p(e){for(var n=[e],o={},t=n.slice().map(function(e){return{chain:[e],id:e}});t.length>0;){var r=t.pop(),s=r.id,i=r.chain;if((a=S[s])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:s};if(a.hot._main)return{type:"unaccepted",chain:i,moduleId:s};for(var c=0;c<a.parents.length;c++){var d=a.parents[c],u=S[d];if(u){if(u.hot._declinedDependencies[s])return{type:"declined",chain:i.concat([d]),moduleId:s,parentId:d};-1===n.indexOf(d)&&(u.hot._acceptedDependencies[s]?(o[d]||(o[d]=[]),g(o[d],[s])):(delete o[d],n.push(d),t.push({chain:i.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:n,outdatedDependencies:o}}function g(e,n){for(var o=0;o<n.length;o++){var t=n[o];-1===e.indexOf(t)&&e.push(t)}}n=n||{};var m={},y=[],b={},_=function(){console.warn("[HMR] unexpected require("+w.moduleId+") to disposed module")};for(var x in f)if(Object.prototype.hasOwnProperty.call(f,x)){var w;d=j(x);var E=!1,T=!1,D=!1,I="";switch((w=f[x]?p(d):{type:"disposed",moduleId:x}).chain&&(I="\nUpdate propagation: "+w.chain.join(" -> ")),w.type){case"self-declined":n.onDeclined&&n.onDeclined(w),n.ignoreDeclined||(E=new Error("Aborted because of self decline: "+w.moduleId+I));break;case"declined":n.onDeclined&&n.onDeclined(w),n.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+w.moduleId+" in "+w.parentId+I));break;case"unaccepted":n.onUnaccepted&&n.onUnaccepted(w),n.ignoreUnaccepted||(E=new Error("Aborted because "+d+" is not accepted"+I));break;case"accepted":n.onAccepted&&n.onAccepted(w),T=!0;break;case"disposed":n.onDisposed&&n.onDisposed(w),D=!0;break;default:throw new Error("Unexception type "+w.type)}if(E)return l("abort"),Promise.reject(E);if(T)for(d in b[d]=f[d],g(y,w.outdatedModules),w.outdatedDependencies)Object.prototype.hasOwnProperty.call(w.outdatedDependencies,d)&&(m[d]||(m[d]=[]),g(m[d],w.outdatedDependencies[d]));D&&(g(y,[w.moduleId]),b[d]=_)}var k,P=[];for(t=0;t<y.length;t++)d=y[t],S[d]&&S[d].hot._selfAccepted&&P.push({module:d,errorHandler:S[d].hot._selfAccepted});l("dispose"),Object.keys(v).forEach(function(e){!1===v[e]&&function(e){delete installedChunks[e]}(e)});for(var A,R,L=y.slice();L.length>0;)if(d=L.pop(),a=S[d]){var U={},H=a.hot._disposeHandlers;for(c=0;c<H.length;c++)(o=H[c])(U);for(s[d]=U,a.hot.active=!1,delete S[d],delete m[d],c=0;c<a.children.length;c++){var M=S[a.children[c]];M&&((k=M.parents.indexOf(d))>=0&&M.parents.splice(k,1))}}for(d in m)if(Object.prototype.hasOwnProperty.call(m,d)&&(a=S[d]))for(R=m[d],c=0;c<R.length;c++)A=R[c],(k=a.children.indexOf(A))>=0&&a.children.splice(k,1);for(d in l("apply"),r=h,b)Object.prototype.hasOwnProperty.call(b,d)&&(e[d]=b[d]);var q=null;for(d in m)if(Object.prototype.hasOwnProperty.call(m,d)&&(a=S[d])){R=m[d];var C=[];for(t=0;t<R.length;t++)if(A=R[t],o=a.hot._acceptedDependencies[A]){if(-1!==C.indexOf(o))continue;C.push(o)}for(t=0;t<C.length;t++){o=C[t];try{o(R)}catch(e){n.onErrored&&n.onErrored({type:"accept-errored",moduleId:d,dependencyId:R[t],error:e}),n.ignoreErrored||q||(q=e)}}}for(t=0;t<P.length;t++){var N=P[t];d=N.module,i=[d];try{O(d)}catch(e){if("function"==typeof N.errorHandler)try{N.errorHandler(e)}catch(o){n.onErrored&&n.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:o,originalError:e}),n.ignoreErrored||q||(q=o),q||(q=e)}else n.onErrored&&n.onErrored({type:"self-accept-errored",moduleId:d,error:e}),n.ignoreErrored||q||(q=e)}}return q?(l("fail"),Promise.reject(q)):(l("idle"),new Promise(function(e){e(y)}))}var S={};function O(n){if(S[n])return S[n].exports;var t=S[n]={i:n,l:!1,exports:{},hot:function(e){var n={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:o!==e,active:!0,accept:function(e,o){if(void 0===e)n._selfAccepted=!0;else if("function"==typeof e)n._selfAccepted=e;else if("object"==typeof e)for(var t=0;t<e.length;t++)n._acceptedDependencies[e[t]]=o||function(){};else n._acceptedDependencies[e]=o||function(){}},decline:function(e){if(void 0===e)n._selfDeclined=!0;else if("object"==typeof e)for(var o=0;o<e.length;o++)n._declinedDependencies[e[o]]=!0;else n._declinedDependencies[e]=!0},dispose:function(e){n._disposeHandlers.push(e)},addDisposeHandler:function(e){n._disposeHandlers.push(e)},removeDisposeHandler:function(e){var o=n._disposeHandlers.indexOf(e);o>=0&&n._disposeHandlers.splice(o,1)},check:_,apply:E,status:function(e){if(!e)return u;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var n=d.indexOf(e);n>=0&&d.splice(n,1)},data:s[e]};return o=void 0,n}(n),parents:(c=i,i=[],c),children:[]};return e[n].call(t.exports,t,t.exports,a(n)),t.l=!0,t.exports}O.m=e,O.c=S,O.d=function(e,n,o){O.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},O.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},O.t=function(e,n){if(1&n&&(e=O(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(O.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var t in e)O.d(o,t,function(n){return e[n]}.bind(null,t));return o},O.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return O.d(n,"a",n),n},O.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},O.p="",O.h=function(){return r},a(0)(O.s=0)}({"../app.js":function(e,n,o){const t=o("express"),r=o("express-fileupload"),s=t();s.use(r());const i=o("body-parser");s.use(i.urlencoded({extended:!1})),s.all("*",function(e,n,o){n.header("Access-Control-Allow-Origin","*"),n.header("Access-Control-Allow-Headers","content-type, Authorization"),n.header("Access-Control-Allow-Methods","DELETE,PUT,POST,GET,OPTIONS"),"options"==e.method.toLowerCase()?n.send(200):o()}),s.all("/*",function(e,n,o){o()});const c=o("../config/index.js"),a=o("../controller/index.js");o("../route/route.js").map(e=>{console.log(`route ${e.method}:${e.path}`);let n=e.impl.split(".");return e.impl=a[n[0]][n[1]],e}).find(e=>{s[e.method](e.path,(n,o)=>{e?e.impl(n,o):(o.statusCode=404,o.setHeader("Content-Type","text/plain"),o.end("Not Found"))})}),s.listen(c.port,c.hostname,()=>{console.log(`Server running at http://${c.hostname}:${c.port}/`)})},"../config/index.js":function(e,n){e.exports={hostname:"192.168.1.213",port:"3000"}},"../controller/file.js":function(e,n,o){"use strict";o.r(n),o.d(n,"upfile",function(){return t});new(o("ali-oss"))({region:"oss-cn-beijing",accessKeyId:"LTAIiG34CxtAl0Kp",accessKeySecret:"TCuePLFvCoSzWkKR4dWjyeBl7zYC2R"});function t(e,n){e.body;console.log(e.files);let o="";null!=e.files?(o=(new Date).getTime()+"_"+e.files.file.name,console.log(o),n.json({code:200,success:!0,message:"上传成功"})):n.json({code:-1,success:!1,message:"上传失败"})}},"../controller/index.js":function(e,n,o){n.user=o("../controller/user.js"),n.file=o("../controller/file.js")},"../controller/user.js":function(e,n,o){"use strict";function t(e,n){if(0===arguments.length)return null;const o=n||"{y}-{m}-{d} {h}:{i}:{s}";let t;"object"==typeof e?t=e:(10===(""+e).length&&(e=1e3*parseInt(e)),t=new Date(e));const r={y:t.getFullYear(),m:t.getMonth()+1,d:t.getDate(),h:t.getHours(),i:t.getMinutes(),s:t.getSeconds(),a:t.getDay()};return o.replace(/{(y|m|d|h|i|s|a)+}/g,(e,n)=>{let o=r[n];return"a"===n?["日","一","二","三","四","五","六"][o]:(e.length>0&&o<10&&(o="0"+o),o||0)})}o.r(n);o.d(n,"register",function(){return i}),o.d(n,"login",function(){return c}),o.d(n,"logout",function(){return a}),o.d(n,"getUserInfo",function(){return d}),o.d(n,"list",function(){return u}),o.d(n,"add",function(){return l}),o.d(n,"del",function(){return p}),o.d(n,"updata",function(){return f});const r=o("../utils/token.js"),s=o("../controller/userModal.js");function i(e,n){s.register(e,n,function(e,o){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"注册成功"})})}function c(e,n){s.login(e,function(o,s){return o?n.json({code:-1,success:!1,message:o}):s.length<=0?n.json({code:-1,success:!1,message:"账号或密码错误"}):void n.json({code:200,success:!0,message:"登陆成功",token:r.setToken({id:s[0].id,account:e.body.account,password:e.body.password,time:t(new Date)})})})}function a(e,n){n.json({code:200,success:!0,message:"成功退出"})}function d(e,n){r.getToken(e.headers.authorization,n,function(o){if(o.success){let a=new Date(o.user.time),d=new Date,u=(i=a,(c=d.getTime()-i.getTime())<0?0:Math.floor(c/1e3/60/60));s.info(e,o.user.account,function(o,s){if(o)return n.json({code:-1,success:!1,message:o});delete s[0].password,s[0].roles=s[0].roles.split(",");let i="";u>23&&u<=24&&(i=r.setToken({id:s[0].id,account:e.body.account,password:e.body.password,time:t(new Date)})),n.json({code:200,success:!0,message:"用户信息获取成功",data:s[0],token:i})})}var i,c})}function u(e,n){r.getToken(e.headers.authorization,n,function(o){o.success&&s.list(e,function(o,r){var s=e.body;if(o)return n.json({code:-1,success:!1,message:"数据不存在"});for(var i in r[1])r[1][i].birthday=t(r[1][i].birthday,"{y}-{m}-{d}"),delete r[1][i].password;n.json({code:200,success:!0,pageNo:s.pageNo,pageSize:s.pageSize,total:r[0][0]["COUNT(*)"],data:r[1]})})})}function l(e,n){r.getToken(e.headers.authorization,n,function(o){s.add(e,function(e,o){if(e)return n.json({err_code:-1,success:!1,message:e});n.json({err_code:200,success:!0,message:"添加成功"})})})}function p(e,n){r.getToken(e.headers.authorization,n,function(o){s.del(e,function(e,o){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"删除成功"})})})}function f(e,n){r.getToken(e.headers.authorization,n,function(o){s.updata(e,function(e,o){if(e)return n.json({code:-1,success:!1,message:e});n.json({code:200,success:!0,message:"编辑成功"})})})}},"../controller/userModal.js":function(e,n,o){o("mysql");const t=o("../utils/SQLcool.js").sqlpool();o("../utils/token.js");var r=o("md5-node");function s(e,n){n=void 0===n?3:n;for(let o=0;o<n;o++)e=r(e);return e}e.exports={register:function(e,n,o){const r=e.body;this.validateAccount(e,function(e,i){if(r.user_name&&""!=r.user_name)if(i.length>0)n.json({code:-1,success:!1,message:"该账号已存在，请重新填写"});else{const e="INSERT INTO USER_LIST(account, password, user_name, sex, age, birthday, roles) VALUES(?,?,?,?,?,?,?)";r.password=s(r.password);var c=[r.account,r.password,r.user_name,r.sex||null,r.age||null,r.birthday||null,r.roles||"admin"];t.connect(e,c,o)}else n.json({code:-1,success:!1,message:"请填写用户名"})})},validateAccount:function(e,n){const o=e.body;t.connect("SELECT * FROM USER_LIST where 1=1 and account=?",[o.account],n)},login:function(e,n){const o=e.body;o.password=s(o.password);var r=[o.account,o.password];t.connect("SELECT * FROM USER_LIST WHERE account=? and password=?",r,n)},info:function(e,n,o){t.connect("SELECT * FROM USER_LIST where account=?",n,o)},list:function(e,n){const o=e.body;let r=[],s="SELECT COUNT(*) FROM USER_LIST";""!=o.user_name||""!=o.sex||""!=o.age||""!=o.birthday?(s+=" where 1=1",o.user_name&&""!=o.user_name&&(o.user_name="%"+o.user_name+"%",s+=" and user_name like ?",r.push(o.user_name)),o.sex&&""!=o.sex&&(s+=" and sex = ?",r.push(o.sex)),o.age&&""!=o.age&&(s+=" and age = ?",r.push(o.age)),o.birthday&&""!=o.birthday&&(s+=" and birthday = ?",r.push(o.birthday)),s+=";"):s+=";",s+="SELECT * FROM USER_LIST where 1=1",o.user_name&&""!=o.user_name&&(o.user_name="%"+o.user_name+"%",s+=" and user_name like ?",r.push(o.user_name)),o.sex&&""!=o.sex&&(s+=" and sex = ?",r.push(o.sex)),o.age&&""!=o.age&&(s+=" and age = ?",r.push(o.age)),o.birthday&&""!=o.birthday&&(s+=" and birthday = ?",r.push(o.birthday)),s+=" limit ?,?",r.push(Number(o.pageNo-1)*Number(o.pageSize)||0,Number(o.pageSize)||10),t.connect(s,r,n)},add:function(e,n){const o=e.body;var r=[o.user_name,o.sex,o.age,o.birthday];t.connect("INSERT INTO USER_LIST( user_name, sex, age, birthday) VALUES(?,?,?,?)",r,n)},del:function(e,n){const o=e.body;let r="?";if("string"!=typeof o.ids)for(var s=0;s<o.ids.length-1;s++)r+=",?";else o.ids=[o.ids];const i="DELETE FROM USER_LIST WHERE id in("+r+")";t.connect(i,o.ids,n)},updata:function(e,n){const o=e.body,r="UPDATE USER_LIST SET user_name=?, sex=?, age=?, birthday=? WHERE id = "+o.id;var s=[o.user_name,o.sex,o.age,new Date(o.birthday),o.id];t.connect(r,s,n)}}},"../route/route.js":function(e,n){e.exports=[{method:"post",path:"/api/register",impl:"user.register"},{method:"post",path:"/api/login",impl:"user.login"},{method:"post",path:"/api/logout",impl:"user.logout"},{method:"post",path:"/api/userinfo",impl:"user.getUserInfo"},{method:"post",path:"/api/userlist",impl:"user.list"},{method:"post",path:"/api/deluser",impl:"user.del"},{method:"post",path:"/api/updatauser",impl:"user.updata"},{method:"post",path:"/api/upfile",impl:"file.upfile"}]},"../utils/SQLcool.js":function(e,n,o){const t=o("mysql");o("body-parser");e.exports.sqlpool=function(){return{config:{host:"39.106.16.151",user:"root",password:"zhishan_888",port:"3306",database:"xiaolongjun",multipleStatements:!0},connect:function(e,n,o){t.createPool(this.config).getConnection(function(t,r){t?console.log(t):r.query(e,n,o)})}}}},"../utils/token.js":function(e,n,o){const t=o("jsonwebtoken"),r=o("fs").readFileSync("./config/private.key");e.exports={setToken:function(e){return t.sign(e,r,{expiresIn:86400})},getToken:function(e,n,o){t.verify(e,r,(e,t)=>{if(e)return console.log(e.message),void n.json({code:50014,success:!1,message:"请重新登陆"});"function"==typeof o&&o({user:t,success:!0})})}}},0:function(e,n,o){e.exports=o("../app.js")},"ali-oss":function(e,n){e.exports=require("ali-oss")},"body-parser":function(e,n){e.exports=require("body-parser")},express:function(e,n){e.exports=require("express")},"express-fileupload":function(e,n){e.exports=require("express-fileupload")},fs:function(e,n){e.exports=require("fs")},jsonwebtoken:function(e,n){e.exports=require("jsonwebtoken")},"md5-node":function(e,n){e.exports=require("md5-node")},mysql:function(e,n){e.exports=require("mysql")}});